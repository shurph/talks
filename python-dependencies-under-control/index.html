<!DOCTYPE html>
<html lang="en">

<head>
    <title>Python + Pipenv: Берём зависимости под контроль!</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="dist/styles/screen-16x10.css">
    <link rel="stylesheet" href="dist/vendors/highlight/styles/github.css">
</head>

<style>
    .slide .terminal.venv p::before {
        content: '(venv) ~$ ';
    }
    .slide .terminal pre {
        white-space: pre;
        margin: 0;
    }
    .slide .terminal.wide {
        width: 100%;
    }
    .slide table.wide {
        width: 100%;
        margin:0;
        
    }
    .slide table.wide td:first-child, .slide table.wide th:first-child {
        padding-left: 0;
    }
    .slide table.wide td:last-child, .slide table.wide th:last-child {
        padding-right: 0;
    }
    .good {
        color: #4cbb17;
        font-weight: bold;
    }
    .bad {
        color: #ed1c24;
        font-weight: bold;
    }
    .slide .terminal mark {
        color: yellow;    
        
        background: none;
        z-index: auto;
        margin: 0;
        padding: 0;
        font-weight: normal;
    }
    .slide .terminal mark.green {
        color: #32fb2d;
    }
    .slide .terminal mark.blue {
        color: #35eaff;
    }
    .slide .terminal mark.orange {
        color: #ff941b;;
    }
    
</style>

<body class="shower list">
    <header class="caption">
        <h1>Python + Pipenv: Берём зависимости под контроль!</h1>
        <p>
            <a href="https://twitter.com/shurph">Николай Сасковец</a>,
            инженер-программист,
            iTechArt
        </p>
    </header>

<!--
--
-- СЛАЙДЫ
--
-->


<!--
--
-- ТИТУЛЬНИК
--
-->
    <section class="slide title">
        <h2 style="font-size: 4.2rem">
            Python + Pipenv:<br> Берём зависимости под контроль!
        </h2>
        
        <div style="text-align: right">        
            <p class="author" >Николай Сасковец</p>
            <p class="date">Feb ??, 2019</p>
        </div>
    </section>



    <section class="slide">
        <h2>План</h2>

        <ul>
            <li>Проблематика</li>
            <li>Какие есть решения
                <ul>
                    <li>Наивные</li>
                    <li>Менее наивные</li>
                    <li>«Промышленные»</li>
                </ul>
            </li>
            <li>Ситуация с пакетированием в питоне</li>
        </ul>
    </section>



    <section class="slide">
        <h2>Как мы это делаем сейчас?</h2>
        
        <br>
        <div class="terminal wide" data-content="Terminal">
            <p>echo celery > requirements.txt
            <p><b style="color:Yellow">./.venv/bin/python -m pip</b> install -r requirements.txt
            <p>source ./.venv/bin/activate
            <p>
        </div>
        <br>
        <div class="terminal venv wide" data-content="Terminal">
            <p>pip freeze
            
                <br>amqp==2.4.0
                <br>billiard==3.5.0.5
                <br>celery==4.2.1
                <br>kombu==4.2.2.post1
                <br>pytz==2018.9
                <br>vine==1.2.0
        </div>
        <p style="font-size: 18px; text-align: right; margin: -20px 0 0 0; padding: 0;">↖ зависимости тянут за собой свои зависимости</p>
    </section>
    
    
    <section class="slide">
        <h2>Концептуальные проблемы текущего подхода</h2>
        
        <br>
        <div class="terminal venv" data-content="Terminal">
            <p>echo celery > requirements.txt
            <p>pip install -r requirements.txt
        </div>
        
        <ul>
            <li>Нет детерминированности. Всё зависит от того,
                <ul>
                    <li>какие версии пакетов у вас <b>уже</b> стоят в окружении,</li>
                    <li>какие версии пакетов есть сейчас в репозитории (PyPI)</li>
                </ul>
            </li>
            <li>Нет предсказуемости: 
                <ul>
                    <li>содержание репозитория (PyPI) может измениться в любой момент<br>
                    <b>и мы об этом даже не узнаем</b></li>
                </ul>
            </li>
        </ul>
    </section>
    
    <section class="slide">
        <h2>Практические проблемы текущего подхода</h2>
        
        <br>
        <div class="terminal venv" data-content="Terminal">
            <p>echo celery > requirements.txt
            <p>pip install -r requirements.txt
        </div>
        
        <ul>
            <li>У разработчика, пришедшего позже, будут стоять другие версии пакетов</li>
            <li>На staging/prod всегда свежайшие пакеты, а у вас локально — нет (если Docker)</li>
            <li>Если же долгоживущие инстансы с долгоживущим venv...
                <ul>
                    <li>На staging и prod будут разные пакеты</li>
                    <li>На разных инстансах prod будут разные пакеты</li>
                </ul>
            </li>
        </ul>
    </section>
    
    <section class="slide">
        <h2>Всё может сильно измениться за месяц-два</h2>
        <center>Celery [ноябрь 2018 : январь 2019]</center>
        <br>
        <div class="terminal venv" data-content="DIFF">
            <pre>
        amqp==2.3.2             |       amqp==2.4.0
        billiard==3.5.0.5       |       billiard==3.5.0.5
        celery==4.2.1           |       celery==4.2.1
        kombu==4.2.2            |       kombu==4.2.2.post1
        pytz==2018.7            |       pytz==2018.9
        vine==1.1.4             |       vine==1.2.0
            </pre>
        </div>
    </section>

    <section class="slide">
        <h2>Всё может сильно измениться за месяц-два</h2>
        <center>Celery [ноябрь 2018 : январь 2019]</center>
        <br>
        <div class="terminal venv" data-content="DIFF">
            <pre>
        amqp==2.3.2             |       amqp==<span style="color:yellow">2.4.0</span>
        billiard==3.5.0.5       |       billiard==3.5.0.5
        celery==4.2.1           |       celery==4.2.1
        kombu==4.2.2            |       kombu==<span style="color:yellow">4.2.2.post1</span>
        pytz==2018.7            |       pytz==<span style="color:yellow">2018.9</span>
        vine==1.1.4             |       vine==<span style="color:yellow">1.2.0</span>
            </pre>
        </div>
    </section>

    <section class="slide">
        <h2>Всё становится сложнее, когда пакетов больше</h2>
        <div class="terminal" data-content="vim &nbsp; diff &nbsp; freeze_09_01_2019.txt &nbsp; freeze_31_01_2019.txt">
            <pre>
 1 +-- 15 lines: amqp==2.4.0    +   1 +-- 15 lines: amqp==2.4.0
16 coreschema==0.0.4               16 coreschema==0.0.4
17 coverage==4.5.2                 17 coverage==4.5.2
18 cryptography==2.4.2             18 cryptography==2.5
19 decorator==4.3.2                19 decorator==4.3.2
20 Django==2.1.5                   20 Django==2.1.5
21 +--  7 lines: django-bulk-up +  21 +--  7 lines: django-bulk-u
28 django-timezone-field==3.0      28 django-timezone-field==3.0
29 djangorestframework==3.9.1      29 djangorestframework==3.9.1
30 docker==3.6.0                   30 docker==3.7.0
31 docker-pycreds==0.4.0           31 docker-pycreds==0.4.0
32 docutils==0.14                  32 docutils==0.14
33 ecdsa==0.13                     33 ecdsa==0.13
   ----------------------------    34 entrypoints==0.3
34 factory-boy==2.11.1             35 factory-boy==2.11.1
35 Faker==1.0.1                    36 Faker==1.0.2
36 flake8==3.6.0                   37 flake8==3.7.3
37 flake8-quotes==1.0.0            38 flake8-quotes==1.0.0
38 +-- 12 lines: flower==0.9.2  +  39 +-- 12 lines: flower==0.9.2
50 Jinja2==2.10                    51 Jinja2==2.10
51 jmespath==0.9.3                 52 jmespath==0.9.3
52 jsondiff==1.1.1                 53 jsondiff==1.1.1
53 jsonpickle==1.0                 54 jsonpickle==1.1
54 kombu==4.2.2.post1              55 kombu==4.2.2.post1
55 MarkupSafe==1.1.0               56 MarkupSafe==1.1.0
56 mccabe==0.6.1                   57 mccabe==0.6.1
57 mock==2.0.0                     58 mock==2.0.0
58 moto==1.3.7                     59 moto==1.3.7
59 openapi-codec==1.3.2            60 openapi-codec==1.3.2
60 opentracing==1.3.0              61 opentracing==1.3.0
61 opentracing-instrumentation>    62 opentracing-instrumentatio>
62 parameterized==0.6.3            63 parameterized==0.6.3
63 parso==0.3.2                    64 parso==0.3.2
64 pbr==5.1.1                      65 pbr==5.1.2
65 pexpect==4.6.0                  66 pexpect==4.6.0
66 pickleshare==0.7.5              67 pickleshare==0.7.5
67 prompt-toolkit==2.0.8           68 prompt-toolkit==2.0.8
68 psycopg2==2.7.7                 69 psycopg2==2.7.7
69 ptyprocess==0.6.0               70 ptyprocess==0.6.0
70 pyaml==18.11.0                  71 pyaml==18.11.0
71 pycodestyle==2.4.0              72 pycodestyle==2.5.0
72 pycountry==18.12.8              73 pycountry==18.12.8
73 pycparser==2.19                 74 pycparser==2.19
74 pycryptodome==3.7.2             75 pycryptodome==3.7.3
75 pyflakes==2.0.0                 76 pyflakes==2.1.0
            </pre>
        </div>
    </section>


    <section class="slide">
        <h2>Всё может сильно измениться и за <span style="color:red">день-два</span></h2>
        <center><b>aiohttp</b> [24.01.2019 : 25.01.2019]</center>
        <br>
        <div class="terminal venv" data-content="DIFF">
            <pre>
    aiohttp==3.5.4
    async-timeout==3.0.1
    attrs==18.2.0
    chardet==3.0.4
    idna==2.8
    idna-ssl==1.1.0
    multidict==4.5.2
    typing-extensions==3.7.2
    yarl==1.3.0
            </pre>
        </div>
    </section>

    <!--<section class="slide red clear">
        <h2 class="shout no-bg">
            История про сломанный aiohttp
        </h2>
    </section>-->
    
    
    
    
    <section class="slide clear">
        <h2 class="shout no-bg">
            Какие есть решения?
        </h2>
    </section>
    
        <section class="slide clear">
        <h2 class="shout no-bg">
            Какие есть решения?
            <br>
            <small style="font-size: 40px;">
            1. Наивное решение <br>
            2. Менее наивное решение <br>
            3. Специализированные инструменты <br>
            
            </small>
        </h2>
    </section>
    
    
    <section class="slide">
        <h2>«Решение» (↼_↼). Наивное решение   </h2>

        <p>Пихаем выхлоп <code>pip freeze</code> в <code>requirements.txt</code>!</p>
       
        <div class="terminal venv" data-content="requirements.txt">
            <p>pip install celery
            <p>pip <span style="color: yellow">freeze > requirements.txt</span>
            <p> ...
            <p>pip install -r requirements.txt
        </div>
        <p>Назовём это <b style="color: red">pip-freeze решения</b>.
    </section>
    
    <section class="slide">
        <h2>Плюсы <b style="color: red">pip-freeze решения</b></h2>
        
        <h2 class="shout no-bg">
            Предсказуемость<b style="color: red">*</b><br>
            Детерминированность<b style="color: red">*</b>
        </h2>
        <div class="imprint" style="font-size: 9.99px; text-align: left;padding: 0 20px;">
            <b style="color: red">*</b>
            На самом деле системы работы с пакетами в большинстве языков устроены так, что вы не можете обеспечить полную детерминированность и предсказуемость, используя public репозитории. И Python здесь — не исключение. Только свои зеркала позволяют хоть с каким-то спокойствием смотреть в будущее.
        </div>
    </section>
    
    <section class="slide">
        <h2>Минусы <b style="color: red">pip-freeze решения</b></h2>
        
        <ul>
            <li>
                <mark>Проблемы</mark> при обновлении:
                <ul>
                    <li>Что — зависимости проекта, а что — зависимости зависимостей?</li>
                    <li>Пакет «запинен» потому что с ним проблемы, или можно обновлять до последнего?</li>
                    <li>И requirements.txt сильно разрастается</li>
                </ul>
            </li>
        </ul>
    </section>
    
    

    
    <section class="slide">
        <h2>Workaround для некоторых минусов</h2>
        <h3 style="font-size: 32px;">Или ещё одно «Решение» (↼_↼). Менее наивное решение</h3>
        <ul>
            <li>Использовать два файла:</li>
            <ul>
                <li><code>requirements.in</code><br>содержит только зависимости проекта</li>
                <li><code>requirements.txt</code><br>содержит «запиненные», <mark>все</mark> зависимости</li>
            </ul>
            <li>Периодически обновлять «запиненный» файл</li>
        </ul>
        <p>Назовём это <b style="color:red">Решение requirement.in</b>.</p>
    </section>
            
    
    

    
    <section class="slide">
        <h2><b style="color:red">Решение requirement.in</b> на практике</h2>
        
        <br>
        <div class="terminal venv" data-content="Terminal">
            <p>echo 'celery<b style="color:Yellow">>=4.2.1,<4.3</b>' > requirements.in
            <p>pip install -r requirements.in
            <p>pip freeze > requirements.txt
            <p>
            <p>sleep 8h
            <p>
            <p>pip install -r requirements.txt
            <p>
            <p>pip freeze
            
                <br>amqp==2.4.0
                <br>billiard==3.5.0.5
                <br>celery==4.2.1
                <br>kombu==4.2.2.post1
                <br>pytz==2018.9
                <br>vine==1.2.0
        </div>
    </section>
    
    
    <section class="slide">
        <h2>Всё ещё есть минусы</h2>
        Недостатки таких «ручных» подходов, как «<b style="color: red">решение requirement.in</b>»
        и «<b style="color: red; white-space: nowrap">pip-freeze решение</b>»:
        <ul>
            <li>
                Предсказуемость и детерминированность не на высоте:
                <ul>
                    <li>мэйнтейнер пакета может:
                        <ul>
                            <li>перезалить пакет <b>с той же версией</b>, и мы этого даже <b>не заметим</b></li>
                            <li>удалить пакет (но мы хотя-бы об этом узнаем)</li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li>Во freeze могут попасть «случайные» пакеты</li>
            <li>Много ручной работы</li>
        </ul>
    </section>




    <section class="slide">
        <h2>Минус: много ручной работы</h2>
        <p>Последовательность команд для обновления «запиненных» зависимостей</p>
        <div class="terminal wide" data-content="Terminal">
            <p>cat requirements.in
            <pre>celery>=4.2.1,<4.3</pre>
            <p>virtualenv ./<span style="color:Yellow">temp-venv</span></p>
            <p>./<span style="color:Yellow">temp-venv</span>/bin/python -m pip install -r requirements.in
            <p>./<span style="color:Yellow">temp-venv</span>/bin/python -m pip freeze > requirements.txt
            <p>rm -rf ./<span style="color:Yellow">temp-venv</span></p></p>
            <p>./<span style="color:CYAN">.venv</span>/bin/python -m pip install -r requirements.txt</p>
        </div>
        <p>Можно, конечно, автоматизировать. Но зачем, когда это уже сделали за нас?</p>
    </section>
    
        
    
    <section class="slide half-black clear">
        <div>
            <h3>Существующие «промышленные» решения</h3>
        </div>
        <div>
            <ul style="font-size: 175%">  
                <li><a href="https://github.com/jazzband/pip-tools/">pip-tools</a></li>
                <li><a href="https://github.com/pypa/pipenv">Pipenv</a></li>
                <li><a href="https://github.com/sdispater/poetry">Poetry</a></li>
            </ul>
        </div>
    </section>



    <section class="slide black clear">
        <h2 class="shout no-bg">
            pip-tools
        </h2>
    </section>


    <section class="slide">
        <h2>pip-tools</h2>
        <p>
            pip-tools — это набор консольных утилит, которые автоматизируют ваш процесс управления установленными с помощью pip пакетов:
            <ul style="padding-left: 4rem">
                <li>pip-compile — генерирует requirements.txt на базе requirements.in или используя данные из setup.py</li>
                <li>pip-sync — устанавливает из сгенерированного с помощью pip-compile файла requirements.txt ровно те пакеты, которые там указаны</li>
            </ul>
        </p>

    </section>


    <section class="slide">
        <h2>pip-tools, установка</h2>
        <br>
        <div class="terminal" data-content="Terminal">
            <p>source /path/to/venv/bin/activate</p>
        </div>
        <br>
        <div class="terminal venv" data-content="Terminal">

            <p>pip install pip-tools</p>
            <p></p>
            <p>pip freeze</p>
            <br>Click==7.0
            <br>pip-tools==3.2.0
            <br>six==1.12.0
        </div>
    </section>


    <section class="slide">
        <h2>pip-compile, requirements.in → requirements.txt</h2>
        <br>
        <div class="terminal venv" data-content="Terminal">
            <p>echo celery > requirements.in</p>
            <p>pip-compile requirements.in <span style="color:yellow">--generate-hashes</span> --output-file requirements.txt</p>
        </div>

        <p>Параметр <mark>--generate-hashes</mark> указывает pip-compile добавить в requirements.txt хэши, которые будут использоваться в дальнейшем алгоритмом проверки хэшей, встроенным в pip (>=8.0) на этапе pip-sync.</p>
    </section>

    <section class="slide">
        <h2>Содержимое requirements.txt (by pip-compile)</h2>
        <div class="terminal" data-content="requirements.txt" style="width: 100%">
            <pre style="overflow:hidden; font-size: 22px; line-height: 22px;">
amqp==2.4.0 \
    --hash=sha256:9f181e4aef6562e6f9f45660578fc1556150ca06e836ecb9e733e6ea10b48464 \
    --hash=sha256:c3d7126bfbc640d076a01f1f4f6e609c0e4348508150c1f61336b0d83c738d2b \
    # via kombu
billiard==3.5.0.5 \
    --hash=sha256:42d9a227401ac4fba892918bba0a0c409def5435c4b483267ebfe821afaaba0e \
    # via celery
celery==4.2.1 \
    --hash=sha256:77dab4677e24dc654d42dfbdfed65fa760455b6bb563a0877ecc35f4cfcfc678 \
    --hash=sha256:ad7a7411772b80a4d6c64f2f7f723200e39fb66cf614a7fdfab76d345acc7b13
kombu==4.2.2.post1 \
    --hash=sha256:1ef049243aa05f29e988ab33444ec7f514375540eaa8e0b2e1f5255e81c5e56d \
    --hash=sha256:3c9dca2338c5d893f30c151f5d29bfb81196748ab426d33c362ab51f1e8dbf78 \
    # via celery
pytz==2018.9 \
    --hash=sha256:32b0891edff07e28efe91284ed9c31e123d84bea3fd98e1f72be2508f43ef8d9 \
    --hash=sha256:d5f05e487007e29e03409f9398d074e158d920d36eb82eaf66fb1136b0c5374c \
    # via celery
vine==1.2.0 \
    --hash=sha256:3cd505dcf980223cfaf13423d371f2e7ff99247e38d5985a01ec8264e4f2aca1 \
    --hash=sha256:ee4813e915d0e1a54e5c1963fde0855337f82655678540a6bc5996bca4165f76 \
    # via amqp
            </pre>
        </div>
    </section>
    
    
    <section class="slide">
        <h2>Содержимое requirements.txt (by pip-compile)</h2>
        <div class="terminal" data-content="requirements.txt" style="width: 100%">
            <pre style="overflow:hidden; font-size: 22px; line-height: 22px;">
amqp==2.4.0 \
    --hash=sha256:9f181e4aef6562e6f9f45660578fc1556150ca06e836ecb9e733e6ea10b48464 \
    --hash=sha256:c3d7126bfbc640d076a01f1f4f6e609c0e4348508150c1f61336b0d83c738d2b \
    <mark class="blue"># via kombu</mark>
billiard==3.5.0.5 \
    --hash=sha256:42d9a227401ac4fba892918bba0a0c409def5435c4b483267ebfe821afaaba0e \
    <mark># via celery</mark>
celery==4.2.1 \
    --hash=sha256:77dab4677e24dc654d42dfbdfed65fa760455b6bb563a0877ecc35f4cfcfc678 \
    --hash=sha256:ad7a7411772b80a4d6c64f2f7f723200e39fb66cf614a7fdfab76d345acc7b13
kombu==4.2.2.post1 \
    --hash=sha256:1ef049243aa05f29e988ab33444ec7f514375540eaa8e0b2e1f5255e81c5e56d \
    --hash=sha256:3c9dca2338c5d893f30c151f5d29bfb81196748ab426d33c362ab51f1e8dbf78 \
    <mark># via celery</mark>
pytz==2018.9 \
    --hash=sha256:32b0891edff07e28efe91284ed9c31e123d84bea3fd98e1f72be2508f43ef8d9 \
    --hash=sha256:d5f05e487007e29e03409f9398d074e158d920d36eb82eaf66fb1136b0c5374c \
    <mark># via celery</mark>
vine==1.2.0 \
    --hash=sha256:3cd505dcf980223cfaf13423d371f2e7ff99247e38d5985a01ec8264e4f2aca1 \
    --hash=sha256:ee4813e915d0e1a54e5c1963fde0855337f82655678540a6bc5996bca4165f76 \
    <mark class="green"># via amqp</mark>
            </pre>
        </div>
    </section>



    <section class="slide">
        <h2>pip-compile, setup.py → requirements.txt</h2>
        <br>
        <div class="terminal venv" data-content="Terminal" style="width: 100%">
            # ... create some python.py with <span style="color:yellow">install_requires=['celery']</span>
            <p>pip-compile --generate-hashes --output-file requirements.txt</p>
        </div>
    </section>

    <section class="slide">
        <h2>pip-sync, установка из requirements.txt</h2>
        <p>Путём процесса установки, удаленеия и обновления пакетов в виртуальном окружении доводит состояние пакетов до точно того состояния, которое описано в requirements.txt, если это возможно.</p>
        <br>
        <div class="terminal venv" data-content="Terminal">
            <p>pip-sync</p>
        </div>
        <p><center>или</center></p>
        <div class="terminal venv" data-content="Terminal">
            <p>pip-sync custom-requirements.txt <span style="color:yellow">another-one.txt</span></p>
        </div>
        <p style="font-size: 22px">* pyp-sync не трогает пакеты инструментов пакетирования (setuptools, pip, pip-tools).</p>
    </section>


    <section class="slide">
        <h2>pip-tools: плюсы и минусы</h2>
        <h4>Плюсы</h4>
        <ul>
            <li>Простой набор инструментов для автоматизации</li>
            <li>Работает достаточно стабильно</li>
        </ul>
        <h4>Минусы</h4>
        <ul>
            <li>Простой набор инструментов</li>
            <li>Слегка устарел</li>
            <li>Не поспевает за изменениями в pip</li>
        </ul>
    </section>

    <section class="slide black clear">
        <h2 class="shout no-bg">
            Pipenv
    </section>

    <section class="slide">
        <h2>Pipenv, почему?</h2>
        <blockquote style="font-size: 40px; padding-left: 20px;">
            Pipenv is a tool that aims to bring the best of all packaging worlds to the Python world.
            <div style="text-align: right; font-size: 24px">
                <a href="https://github.com/kennethreitz"><strong>Kenneth Reitz</strong></a>,
                создатель библиотеки
                <a href="https://github.com/requests"><strong>requests</strong></a>.
            </div>
        </blockquote>
        <br><br>
        <blockquote style="font-size: 40px; padding-left: 20px">
            Your tool of choice these days should be <a href="">Pipenv</a>.
            <div style="text-align: right; font-size: 24px">
                <a href="https://github.com/nvie"><strong>Vincent Driessen</strong></a>,
                создатель
                <a href="https://github.com/jazzband/pip-tools/"><strong>pip-tools</strong></a>.
            </div>
        </blockquote>
    </section>




<section class="slide">
        <h2>Что такое Pipenv на самом деле?</h2>
        Инструмент для <mark>приложений</mark>, не библиотек, который может:
        <ul>
            <li>Управлять окружениями
                <strong>(env)</strong>
            </li>
            <li>Управлять пакетами: устанавливать и удалять
                <strong>(pip)</strong>
            </li>
            <li>Устанавливать <strong>детерминированный</strong> набор пакетов
                <strong>(Pipfile.lock)</strong>
            </li>
            <li><strike>Проверять код на соответствие стайл-гайдам (flake8)</strike></li>
        </ul>
    </section>
    
    
    <section class="slide">
        <h2>Pipenv: Pipfile + Pipfile.lock</h2>
        <ul>
            <li><code>Pipfile.lock</code> — содержит «запиненные», <mark>все</mark> зависимости, необходимые для запуска и работы проекта. Генерируется на основе Pipfile.</li>
            <li><code>Pipfile</code> — содержит только зависимости проекта и мета-информацию о зависимостях.</li>
        </ul>
    </section>
    
    
    
    <section class="slide">
        <h2>Pipenv: Pipfile</h2>
        
        <p>Список необходимых для установки пакетов декларируется в файле <mark>Pipfile</mark>, вместо привычного всем <code>requirements.txt</code>.</p>
        
        <p>Pipfile:</p>
        <ul>
            <li>Использует TOML для простоты чтения и написание</li>
            <li>Позволяет указать два списка пакетов: packages и dev-packages (для окружения разработчика)</li>
            <li>Стремится стать новым стандартом, заменой requirements.txt</li>
        </ul>
    </section>
    
    <section class="slide">
        <h2>Pipfile: что внутри?</h2>
        <br>
        <div class="terminal" data-content="Pipfile" style="width: 100%">
            <pre style="overflow:hidden; font-size: 24px; line-height: 26px;">
[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"
[packages]
django = "*"
celery = "*"
[dev-packages]
"flake8" = "*"
moto = "==1.3.4"
[requires]
python_version = "3.6"
        </pre></div>
    </section>
    
    
    <section class="slide">
        <h2>Pipfile: можно указывать свой PyPI</h2>
        <br>
        <div class="terminal" data-content="Pipfile" style="width: 100%">
            <pre style="overflow:hidden; font-size: 24px; line-height: 26px;">
[[source]]
<span style="color:yellow">url = "https://pypi.org/simple"</span>
verify_ssl = true
name = "pypi"
[packages]
django = "*"
celery = "*"
[dev-packages]
"flake8" = "*"
moto = "==1.3.4"
[requires]
python_version = "3.6"
        </pre></div>
    </section>
    
    <section class="slide">
        <h2>Pipfile: указывается версия питона для проекта</h2>
        <br>
        <div class="terminal" data-content="Pipfile" style="width: 100%">
            <pre style="overflow:hidden; font-size: 24px; line-height: 26px;">
[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"
[packages]
django = "*"
celery = "*"
[dev-packages]
"flake8" = "*"
moto = "==1.3.4"
[requires]
<span style="color:yellow">python_version = "3.6"</span>
        </pre></div>
    </section>
    
    <section class="slide">
        <h2>Pipfile: диапазоны версий, как в requiements.txt</h2>
        <br>
        <div class="terminal" data-content="Pipfile" style="width: 100%">
            <pre style="overflow:hidden; font-size: 24px; line-height: 26px;">
[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"
[packages]
django = <span style="color:yellow">"*"</span>
celery = "*"
elasticsearch = <span style="color:yellow">"<6.0.0,>=5.0.0"</span>
[dev-packages]
"flake8" = "*"
moto = <span style="color:yellow">"==1.3.4"</span>
[requires]
python_version = "3.6"
        </pre></div>
    </section>
    
    
    
    
    
    <section class="slide">
        <h2>Pipfile: свой синтаксис для Git-ссылок</h2>
        <br>
        <div class="terminal" data-content="Pipfile" style="width: 100%">
            <pre style="overflow:hidden; font-size: 24px; line-height: 26px;">
[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"
[packages]
django = "*"
celery = "*"
elasticsearch = "<6.0.0,>=5.0.0"
api_client = <span style="color:yellow">{git =
    "ssh://git@gitlab.com/something/api-client.git",
    ref = "v1.0.2"}</span>
[dev-packages]
"flake8" = "*"
moto = "==1.3.4"
[requires]
python_version = "3.6"</pre></div>
    </section>
    
    
   
    <section class="slide">
        <h2>Pipfile: несколько PyPI репозиториев</h2>
        <div class="terminal" data-content="Pipfile" style="width: 100%">
            <pre style="overflow:hidden; ">
[[source]]
url = <span style="color:yellow">"https://pypi.org/simple"</span>
verify_ssl = true
name = "<span style="color:CYAN">pypi</span>"

[[source]]
url = <span style="color:yellow">"http://pypi.famous.org/simple"</span>
verify_ssl = false

name = "<span style="color:CYAN">famous</span>"
[packages]
django = <span style="color:yellow">"*"</span>
celery = <span style="color:yellow">{version="*", index="<span style="color:CYAN">pypi</span>"}</span>
api_base_client = <span style="color:yellow">{version="*", index="<span style="color:CYAN">famous</span>"}</span>
api_client = {git="ssh://git@gitlab.com/something/api-client.git",ref = "v1.0.2"}
[dev-packages]
"flake8" = "*"
moto = "==1.3.4"
[requires]
python_version = "3.6"</pre></div>
    </section>
     
    
    
    
    
    


    <section class="slide">
        <h2>Pipfile<span style="color:#ed1c24">.lock</span>, что внутри?</h2>
        <ul>
            <li>Все пакеты из  Pipfile, с запинеными версиями</li>
            <li>Все зависимости этих пакетов, также с запинеными версиями</li>
            <li>Хэш-суммы всех перечисленных пакетов</li>
            <li>Хэш-сумма Pipfile</li>
            <li>Meta</li>
        </ul>
    </section>
    
    <section class="slide">
        <h2>Pipfile.lock, что внутри? Пустой проект:</h2>
        <div class="terminal" data-content="Pipfile.lock" style="width: 100%">
            <pre style="overflow:hidden; ">{
    "_meta": {
        "hash": {
            "sha256": "415dfdcb118dd9bdfef17671cb7dcd78dbd69b6ae7d4f39e8b44e71d60ca72e7"
        },
        "pipfile-spec": 6,
        "requires": {
            "python_version": "3.6"
        },
        "sources": [
            {
                "name": "pypi",
                "url": "https://pypi.org/simple",
                "verify_ssl": true
            }
        ]
    },
    "default": {},
    "develop": {}
}</pre>
        </div>
    </section>
    
    
    <section class="slide">
        <h2>Pipfile.lock, что внутри? Пустой проект:</h2>
        <div class="terminal" data-content="Pipfile.lock" style="width: 100%">
            <pre style="overflow:hidden; ">{
    "_meta": {
        <span style="color: yellow">"hash": {
            "sha256": "415dfdcb118dd9bdfef17671cb7dcd78dbd69b6ae7d4f39e8b44e71d60ca72e7"
        },</span>
        "pipfile-spec": 6,
        "requires": {
            "python_version": "3.6"
        },
        "sources": [
            {
                "name": "pypi",
                "url": "https://pypi.org/simple",
                "verify_ssl": true
            }
        ]
    },
    "default": {},
    "develop": {}
}</pre>
        </div>
    </section>
    
    
    
    
    <section class="slide">
        <h2>Pipfile.lock, что внутри? Пустой проект:</h2>
        <div class="terminal" data-content="Pipfile.lock" style="width: 100%">
            <pre style="overflow:hidden; ">{
    "_meta": {
        "hash": {
            "sha256": "415dfdcb118dd9bdfef17671cb7dcd78dbd69b6ae7d4f39e8b44e71d60ca72e7"
        },
        "pipfile-spec": 6,
        "requires": {
            "python_version": "3.6"
        },
        <span style="color: yellow">"sources": [
            {
                "name": "pypi",
                "url": "https://pypi.org/simple",
                "verify_ssl": true
            }
        ]</span>
    },
    "default": {},
    "develop": {}
}</pre>
        </div>
    </section>
    
    
    
    
    
    <section class="slide">
        <h2>Pipfile.lock: Секция default для celery</h2>
        <div class="terminal" data-content="Pipfile.lock" style="width: 100%">
            <pre style="overflow:hidden; ">
"default": {
    "amqp": {
        "hashes": [
            "sha256:9f181e4aef6562e6f9f45660578fc1556150ca06e836ecb9e733e6ea10b48464",
            "sha256:c3d7126bfbc640d076a01f1f4f6e609c0e4348508150c1f61336b0d83c738d2b"
        ],
        "version": "==2.4.0"
    },
    "billiard": {
        "hashes": [
            "sha256:42d9a227401ac4fba892918bba0a0c409def5435c4b483267ebfe821afaaba0e"
        ],
        "version": "==3.5.0.5"
    },
    "celery": {
        "hashes": [
            "sha256:77dab4677e24dc654d42dfbdfed65fa760455b6bb563a0877ecc35f4cfcfc678",
            "sha256:ad7a7411772b80a4d6c64f2f7f723200e39fb66cf614a7fdfab76d345acc7b13"
        ],
        "index": "pypi",
        "version": "==4.2.1"
    },
    "kombu": {
        "hashes": [
            "sha256:1ef049243aa05f29e988ab33444ec7f514375540eaa8e0b2e1f5255e81c5e56d",
            "sha256:3c9dca2338c5d893f30c151f5d29bfb81196748ab426d33c362ab51f1e8dbf78"
        ],
        "version": "==4.2.2.post1"
    },
    "pytz": {
        "hashes": [
            "sha256:32b0891edff07e28efe91284ed9c31e123d84bea3fd98e1f72be2508f43ef8d9",
            "sha256:d5f05e487007e29e03409f9398d074e158d920d36eb82eaf66fb1136b0c5374c"
        ],
        "version": "==2018.9"
    },
    "vine": {
        "hashes": [
            "sha256:3cd505dcf980223cfaf13423d371f2e7ff99247e38d5985a01ec8264e4f2aca1",
            "sha256:ee4813e915d0e1a54e5c1963fde0855337f82655678540a6bc5996bca4165f76"
        ],
        "version": "==1.2.0"
    }
},
            </pre>
        </div>
    </section>
    
    
    
    
    <section class="slide">
        <h2>Pipfile.lock: Секция default для celery</h2>
        <div class="terminal" data-content="Pipfile.lock" style="width: 100%">
            <pre style="overflow:hidden; ">
"default": {
    "amqp": {
        "hashes": [
            "sha256:9f181e4aef6562e6f9f45660578fc1556150ca06e836ecb9e733e6ea10b48464",
            "sha256:c3d7126bfbc640d076a01f1f4f6e609c0e4348508150c1f61336b0d83c738d2b"
        ],
        "version": "==2.4.0"
    },
    "billiard": {
        "hashes": [
            "sha256:42d9a227401ac4fba892918bba0a0c409def5435c4b483267ebfe821afaaba0e"
        ],
        "version": "==3.5.0.5"
    },
    "celery": {
        "hashes": [
            "sha256:77dab4677e24dc654d42dfbdfed65fa760455b6bb563a0877ecc35f4cfcfc678",
            "sha256:ad7a7411772b80a4d6c64f2f7f723200e39fb66cf614a7fdfab76d345acc7b13"
        ],
        <span style="color: yellow">"index": "pypi",</span>
        "version": "==4.2.1"
    },
    "kombu": {
        "hashes": [
            "sha256:1ef049243aa05f29e988ab33444ec7f514375540eaa8e0b2e1f5255e81c5e56d",
            "sha256:3c9dca2338c5d893f30c151f5d29bfb81196748ab426d33c362ab51f1e8dbf78"
        ],
        "version": "==4.2.2.post1"
    },
    "pytz": {
        "hashes": [
            "sha256:32b0891edff07e28efe91284ed9c31e123d84bea3fd98e1f72be2508f43ef8d9",
            "sha256:d5f05e487007e29e03409f9398d074e158d920d36eb82eaf66fb1136b0c5374c"
        ],
        "version": "==2018.9"
    },
    "vine": {
        "hashes": [
            "sha256:3cd505dcf980223cfaf13423d371f2e7ff99247e38d5985a01ec8264e4f2aca1",
            "sha256:ee4813e915d0e1a54e5c1963fde0855337f82655678540a6bc5996bca4165f76"
        ],
        "version": "==1.2.0"
    }
},
            </pre>
        </div>
    </section>
    
    
    
    
    
    
    
    
    <section class="slide">
        <h2>Pipfile.lock: Секция default для celery</h2>
        <div class="terminal" data-content="Pipfile.lock" style="width: 100%">
            <pre style="overflow:hidden;font-size: 13px; line-height: 11.5px ">
"default": {
    "amqp": {
        "hashes": [
            "sha256:9f181e4aef6562e6f9f45660578fc1556150ca06e836ecb9e733e6ea10b48464",
            "sha256:c3d7126bfbc640d076a01f1f4f6e609c0e4348508150c1f61336b0d83c738d2b"
        ],
        "version": "==2.4.0"
    },
    "billiard": {
        "hashes": [
            "sha256:42d9a227401ac4fba892918bba0a0c409def5435c4b483267ebfe821afaaba0e"
        ],
        "version": "==3.5.0.5"
    },
    "celery": {
        "hashes": [
            "sha256:77dab4677e24dc654d42dfbdfed65fa760455b6bb563a0877ecc35f4cfcfc678",
            "sha256:ad7a7411772b80a4d6c64f2f7f723200e39fb66cf614a7fdfab76d345acc7b13"
        ],
        "index": "pypi",
        "version": "==4.2.1"
    },
    "kombu": {
        "hashes": [
            "sha256:1ef049243aa05f29e988ab33444ec7f514375540eaa8e0b2e1f5255e81c5e56d",
            "sha256:3c9dca2338c5d893f30c151f5d29bfb81196748ab426d33c362ab51f1e8dbf78"
        ],
        "version": "==4.2.2.post1"
    },
    "pytz": {
        "hashes": [
            "sha256:32b0891edff07e28efe91284ed9c31e123d84bea3fd98e1f72be2508f43ef8d9",
            "sha256:d5f05e487007e29e03409f9398d074e158d920d36eb82eaf66fb1136b0c5374c"
        ],
        "version": "==2018.9"
    },
    "vine": {
        "hashes": [
            "sha256:3cd505dcf980223cfaf13423d371f2e7ff99247e38d5985a01ec8264e4f2aca1",
            "sha256:ee4813e915d0e1a54e5c1963fde0855337f82655678540a6bc5996bca4165f76"
        ],
        "version": "==1.2.0"
    }
},
            </pre>
        </div>
    </section>
    
    
    
    
    
    
    
    <section class="slide">
        <h2>Управление пакетами</h2>
        
        <p>Установка пакетов:</p>
        
        <div class="terminal" data-content="Terminal" style="width:100%">
            <p>pipenv install celery</p>
            <pre>Installing celery…
✔ Installation Succeeded 
Pipfile.lock (c07081) out of date, updating to (ca72e7)…
Locking [dev-packages] dependencies…
Locking [packages] dependencies…
✔ Success! 
Updated Pipfile.lock (c07081)!
Installing dependencies from Pipfile.lock (c07081)…
  🐍   ▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉ 6/6 — 00:00:01
To activate this project's virtualenv, run pipenv shell.
Alternatively, run a command inside the virtualenv with pipenv run.</pre>
        </div>
    </section>
    
    
    <!--<section class="slide">
    <h2>pipenv install, первый запуск</h2>
    <div class="terminal" data-content="Terminal" style="width:100%">
            <p>pipenv install celery</p>
            <pre>
Creating a virtualenv for this project…
Pipfile: /home/develop/tmp/pipenv-celery-v3/Pipfile
Using /usr/bin/python3 (3.6.7) to create virtualenv…
⠇ Creating virtual environment...Already using interpreter /usr/bin/python3
Using base prefix '/usr'
New python executable in /home/develop/.venvs/pipenv-celery-v3-kxjm_TGY/bin/python3
Also creating executable in /home/develop/.venvs/pipenv-celery-v3-kxjm_TGY/bin/python
Installing setuptools, pip, wheel...done.
✔ Successfully created virtual environment! 
Virtualenv location: /home/develop/.venvs/pipenv-celery-v3-kxjm_TGY
Creating a Pipfile for this project…

Installing celery…
✔ Installation Succeeded 
Pipfile.lock (c07081) out of date, updating to (ca72e7)…
Locking [dev-packages] dependencies…
Locking [packages] dependencies…
✔ Success! 
Updated Pipfile.lock (c07081)!
Installing dependencies from Pipfile.lock (c07081)…
  🐍   ▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉ 6/6 — 00:00:01
To activate this project's virtualenv, run pipenv shell.
Alternatively, run a command inside the virtualenv with pipenv run.



</pre>
        </div>
    </section><!-- -->
    
    
    
    <section class="slide">
        <h2>Управление пакетами: pipenv install</h2>
        Два варианта.
        
        <ol>        
            <li>Указываем пакет, который нужно установить:
                <code>pipenv install celery</code>
                <ul>
                    <li>добавляет celery в <code>Pipfile</code></li>
                    <li>устанавливает celery</li>
                    <li>обновляет <code>Pipfile.lock</code></li>
                </ul>
            
            <li>Не указываем пакет:
                <code>pipenv install</code>
                <ul>
                    <li>устанавливает всё из <code>Pipfile</code></li>
                    <li>обновляет <code>Pipfile.lock</code></li>
                </ul>
            </li>
        </ol>
    
    </section>
        
        
    <section class="slide">
        <h2>Управление пакетами</h2>
        <p>Удаление пакетов:</p>
        <div class="terminal" data-content="Terminal" style="width: 100%">
            <p><span style="color:yellow">pipenv uninstall celery</span></p>
            <pre>Uninstalling celery…
Uninstalling celery-4.2.1:
  Successfully uninstalled celery-4.2.1</pre>
            <p><span style="color:yellow">pip freeze</span></p>
            <pre>amqp==2.4.0
billiard==3.5.0.5
kombu==4.2.2.post1
pytz==2018.9
vine==1.2.0</pre>
            <p><span style="color:yellow">pipenv clean</span></p>
            <pre>Uninstalling vine…
Uninstalling pytz…
Uninstalling kombu…
Uninstalling billiard…
Uninstalling amqp…</pre>
        </div>
    </section>
    
    
    <section class="slide">
        <h2>Управление пакетами: pipenv graph</h2>
        
        <p>&nbsp;</p>
        
        <div class="terminal" data-content="Terminal">
            <p>pipenv graph</p>
            <pre>
celery==4.2.1
  - billiard [required: >=3.5.0.2,<3.6.0, installed: 3.5.0.5]
  - kombu [required: >=4.2.0,<5.0, installed: 4.2.2.post1]
    - amqp [required: >=2.1.4,<3.0, installed: 2.4.0]
      - vine [required: >=1.1.3, installed: 1.2.0]
  - pytz [required: >dev, installed: 2018.9]

            </pre>
        </div>
        
    </section>
    
    <section class="slide">
        <h2>Управление пакетами: pipenv graph</h2>
        
        <p>Решение проблем с недекларированными зависимостями в библиотеках</p>
        
        <div class="terminal" data-content="Terminal">
            <p>pipenv install factory-boy python-slugify==2.0.0</span></p>
            <p>pipenv graph | <span style="color:yellow">grep -iE 'unidecode|'</span></p>
            <pre>
factory-boy==2.11.1
  - Faker [required: >=0.7.0, installed: 1.0.2]
    - python-dateutil [required: >=2.4, installed: 2.7.5]
      - six [required: >=1.5, installed: 1.12.0]
    - six [required: >=1.10, installed: 1.12.0]
    - text-<span style="color:yellow">unidecode</span> [required: ==1.2, installed: 1.2]
python-slugify==2.0.1
            </pre>
        </div>
        
    </section>
    
    
    
    <section class="slide">
        <h2>Управление пакетами: ещё немного CLI</h2>
        <ul>
            <li>
                <code>pipenv lock</code> — генерация Pipfile.lock</li>
            <li>
                <code>pipenv update</code> — обновление версий запиненных пакетов в Pipfile.lock</li>
            
            <li>
                <code>pipenv sync</code> — установка пакетов, указанных в Pipfile.lock
                <br>
                <span style="opacity:0"><code>pipenv sync</code> —&nbsp;</span>
                (игнорирует Pipfile, может быть полезно для прода)</li>
        </ul>
    </section>
    
    
    <section class="slide">
        <h2>Управление окружениями</h2>
        <ul>
        
        <li>Используется virtualenv под капотом.
        </li>
        <li>Все виртуальные окружения, по умолчанию, хранятся в каталоге <code>~/.virtualenvs/</code>.
            <ul>
                <li>Это можно изменить:
                    <br>
                    <code>export WORKON_HOME=~/.venvs</code>
                </li>
                <li>Или даже так:
                    <br>
                    <code>export PIPENV_VENV_IN_PROJECT=True</code>
                    <br>
                    (окружение будет в каталоге <code>.venv</code> внутри каталога проекта)
                </li>
            </ul>
        </li>
        </ul>
    </section>
    
    <section class="slide">
        <h2>Работа внутри виртуального окружения</h2>
        <ul>
            <li>Запустить скрипт с нужным виртуальным окружением <b>единоразово</b>:
                <br>
                <code>pipenv run script-name.py</code>
            </li>
            <li>Активировать виртуальное окружение для выполнения команд в интерактивном режиме:
                <br>
                <code>pipenv shell</code>
            </li>
        </ul>
    </section>
    
    <section class="slide">
        <h2>Возможные проблемы с virtualenv + Pipenv</h2>
        
            <ul>
            <li>В <mark>shell</mark> режиме у некоторых людей появлялись проблемы с башем
            </li>
            <li>В <mark>run</mark> режиме не устанавливается переменная <code>$VIRTUAL_ENV</code>, соответствующая пути к виртуальному окружению</li>
        </ul>
    </section>
    
    
    
    
    
    
    
    
    <section class="slide">
        <h2>Неужели всё так хорошо?</h2>
    </section>
    
    
    <section class="slide">
        <h2>Неужели всё так хорошо?</h2>
        <ul>
            <li>Pipenv very slow. Takes an hour to install and lock. <a href="https://github.com/pypa/pipenv/issues/2873">[#2873]</a></li>
            <li>Pipenv ignores explicitly specified index for package <a href="https://github.com/pypa/pipenv/issues/2730">[#2730] (closed)</a></li>
            <li>Pipenv is installing things without executing setup.py in the target environment <a href="https://github.com/tornadoweb/tornado/issues/2433">[Tornado #2433]</a></li>
        </ul>
    </section>


    <section class="slide red clear">
        <h2 class="shout no-bg">Ещё варианты?</h2>
    </section>
    
    

    <section class="slide black clear">
        <h2 class="shout no-bg">
            Poetry
    </section>

    <section class="slide">
        <h2>Poetry</h2>
        <p>Инструмент для управления зависимостями, который покрывает не только «проекты», но и библиотеки.</p>
        <p>В качестве конфигурационного файла используется <mark>pyproject.toml</mark></p>

        <p>poetry uses <b>standardized</b> pyproject.toml to replace <code>setup.py</code>, <code>requirements.txt</code>, <code>setup.cfg</code>, <code>MANIFEST.in</code> and the newly added <code>Pipfile</code>.</p>

        <p>Подробнее о poetry:&nbsp; <a class="link link-github" href="https://github.com/sdispater/poetry/">https://github.com/sdispater/poetry/</a></p>
    </section>




    <section class="slide clear">
        <h2 class="shout no-bg" style="font-size: 4rem">
            Больше про<br>
            <code>pyproject.toml</code><br>
            и около

            <br>
            <br>
            <a href="https://www.python.org/dev/peps/pep-0516/">PEP 516</a>,
            <a href="https://www.python.org/dev/peps/pep-0517/">PEP 517</a>,
            <a href="https://www.python.org/dev/peps/pep-0518/">PEP 518</a>
            <br><br>
            <a href="https://snarky.ca/clarifying-pep-518/">CLARIFYING PEP 518</a>
        </h2>
    </section>



    <section class="slide">
        <h2>Поддержка pyproject.toml</h2>
        <p>Уже поддерживают: poetry, flit, black.</p>
        <p>В планах:
            <a href="https://github.com/pytest-dev/pytest/issues/1556">pytest</a>,
            <a href="https://gitlab.com/pycqa/flake8/issues/428">flake8</a>,
            <a href="https://bitbucket.org/ned/coveragepy/issues/664/allow-configuration-via-pyprojecttoml">coverage</a>.
        <p>Не собираются тратить на это время:
            <a href="https://github.com/python/mypy/issues/5205">mypy</a>.
    </section>



    <section class="slide">
        <h2>Общие недостатки</h2>
        <ul>
            <li>
                Предсказуемость и детерминированность всё-таки не на высоте:
                <ul>
                    <li>мэйнтейнер пакета может:
                        <ul>
                            <li>перезалить пакет <b>с той же версией</b> (но мы хотя-бы об этом узнаем)</li>
                            <li>удалить пакет (и об этом — тоже)</li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
        <b>Как решать:</b> свой кэширующий PyPI сервер.
    </section>



    <section class="slide">
        <h2>Сравниваем инструменты и подходы</h2>
            <table class="wide" style="font-size:22px;">
                <tr>
                    <td></td>
                    <td style="width: 20%">requirements.txt</td>
                    <td style="width: 12%">pip-tools</td>
                    <td style="width: 10%">pipenv</td>
                    <td style="width: 10%">poetry</td>
                </tr>
                <tr>
                    <td>проверка хэшей</td>
                    <td class="good">да</td><td class="good">да</td><td class="good">да</td><td class="good">да</td>
                </tr>
                <tr>
                    <td>генерация хэшей</td>
                    <td class="bad">нет</td><td class="good">да</td><td class="good">да</td><td class="good">да</td>
                </tr>
                <tr>
                    <td>разные PyPI</td>
                    <td class="bad">нет</td><td class="bad">нет</td><td class="good">да</td><td class="good">да</td>
                </tr>
                <tr>
                    <td>разные версии Python</td>
                    <td class="bad">нет</td><td class="bad">нет</td><td class="bad">нет</td><td class="good">да</td>
                </tr>
                <tr>
                    <td>встроенная работа с виртуальным окружением</td>
                    <td class="bad">нет</td><td class="bad">нет</td><td class="good">да</td><td class="good">да</td>
                </tr>
                <tr>
                    <td>подходит для управления зависимостями библиотек</td>
                    <td class="bad">нет</td><td class="bad">нет</td><td class="bad">нет</td><td class="good">да</td>
                </tr>
                <tr>
                    <td>публикация вашего проекта на PyPI</td>
                    <td class="bad">нет</td><td class="bad">нет</td><td class="bad">нет</td><td class="good">да</td>
                </tr>
                <!--<tr>
                    <td>встроенная проверка соответствия стайл-гайдам</td>
                    <td class="bad">нет</td><td class="bad">нет</td><td style="color:orange">уже нет</td><td class="bad">нет</td>
                </tr><!-- -->
            </table>
    </section>

    <section class="slide half-red">
        <div>
            <h3>Выводы</h3>
        </div>
        <div>
            <ul>  
                <li>Мы живём в эпоху перемен</li>
                <li>Если ваш подход уже отлажен,<br> не стоит сейчас что-то менять</li>
                
                <li>Если стартуете новый проект, то — Pipenv</li>
            </ul>
        </div>
    </section>
    

    <section class="slide half-black">
        <div>
            <h3>Links</h3>
        </div>
        <div>
            <ul style="font-size: 66.6%">  
                <li>
                    <a href="https://nvie.com/posts/pin-your-packages/" class="">Pin Your Packages</a>
                    <span>by</span>
                    <span>Vincent Driessen</span>
				</li>
                <li>
                    <a href="https://nvie.com/posts/better-package-management/" class="">Better Package Management</a>
                    <span>by</span>
                    <span>Vincent Driessen</span>
				</li>
            </ul>
        </div>
    </section>
    

    <div class="progress"></div>

    <footer class="badge">
        <a href="https://github.com/shurph/talks">Fork me on GitHub!</a>
    </footer>

    <script src="dist/scripts/shower.min.js"></script>
    
    <script src="dist/vendors/highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</body>

</html>
</li>
